<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–≤–µ—Å—Ç 2026 ‚Äì –ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –º–∞–≥–∞–∑–∏–Ω</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Arial', sans-serif;
        }

        :root {
            --space-dark: #0b0d1e;
            --space-purple: #1a1a3a;
            --neon-blue: #4e54f5;
            --neon-cyan: #3dc2ec;
            --neon-pink: #f72585;
            --neon-green: #06d6a0;
            --star-color: rgba(255, 255, 255, 0.8);
            --card-bg: rgba(20, 25, 45, 0.9);
            --text-light: #f0f0f0;
            --text-dim: #aaa;
        }

        body {
            background: radial-gradient(ellipse at top, #1a1a3a, #0a0a1a);
            min-height: 100vh;
            padding: 16px;
            position: relative;
            overflow-x: hidden;
        }

        /* –ó–≤—ë–∑–¥–Ω—ã–π —Ñ–æ–Ω */
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: transparent;
            background-image: 
                radial-gradient(2px 2px at 10px 20px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 30px 70px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(3px 3px at 80px 40px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(1px 1px at 150px 180px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 250px 300px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(3px 3px at 350px 150px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 450px 500px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 550px 700px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(3px 3px at 650px 400px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(1px 1px at 750px 900px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 850px 200px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 950px 600px, var(--star-color), rgba(0,0,0,0));
            background-repeat: repeat;
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .app {
            background: rgba(10, 15, 30, 0.7);
            backdrop-filter: blur(12px);
            border-radius: 40px;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            overflow: hidden;
            min-height: 90vh;
            color: var(--text-light);
        }

        /* –≠–∫—Ä–∞–Ω—ã */
        .screen {
            display: none;
        }
        .screen.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –®–∞–ø–∫–∞ */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            background: rgba(0,0,0,0.3);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(145deg, var(--neon-blue), var(--neon-cyan));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: white;
            box-shadow: 0 0 20px var(--neon-blue);
        }

        .logo-text h1 {
            font-size: 26px;
            font-weight: 600;
            background: linear-gradient(135deg, #fff, #b0b0ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .logo-text p {
            font-size: 14px;
            color: var(--text-dim);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
            background: rgba(0,0,0,0.5);
            padding: 8px 20px;
            border-radius: 40px;
            border: 1px solid rgba(255,255,255,0.15);
        }

        .impulse-badge {
            background: linear-gradient(145deg, var(--neon-green), #0a9);
            color: #000;
            font-weight: bold;
            padding: 6px 16px;
            border-radius: 30px;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 0 15px var(--neon-green);
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            padding: 12px 28px;
            border: none;
            border-radius: 40px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            background: rgba(255,255,255,0.05);
            color: white;
            border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(5px);
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
            border-color: var(--neon-cyan);
        }
        .btn-primary {
            background: linear-gradient(145deg, var(--neon-blue), #3a3fd4);
            border: none;
        }
        .btn-success {
            background: linear-gradient(145deg, var(--neon-green), #059669);
            border: none;
        }
        .btn-danger {
            background: linear-gradient(145deg, var(--neon-pink), #c41e6b);
            border: none;
        }
        .btn-outline {
            background: transparent;
            border: 2px solid var(--neon-cyan);
            color: var(--neon-cyan);
        }

        /* –¢–∞–±—ã */
        .tabs {
            display: flex;
            gap: 5px;
            background: rgba(0,0,0,0.3);
            padding: 8px;
            border-radius: 50px;
            margin-bottom: 30px;
        }
        .tab-btn {
            padding: 10px 24px;
            border-radius: 40px;
            background: transparent;
            border: none;
            color: var(--text-dim);
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
            font-size: 16px;
        }
        .tab-btn.active {
            background: var(--neon-blue);
            color: white;
            box-shadow: 0 0 15px var(--neon-blue);
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç */
        .dashboard {
            padding: 30px;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 24px;
            margin-bottom: 40px;
        }
        .stat-card {
            background: var(--card-bg);
            border-radius: 30px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.05);
            backdrop-filter: blur(5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .stat-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 20px;
            background: rgba(78, 84, 245, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: var(--neon-cyan);
        }
        .stat-value {
            font-size: 42px;
            font-weight: 700;
            line-height: 1;
            background: linear-gradient(135deg, #fff, #b0b0ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .stat-label {
            font-size: 14px;
            color: var(--text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* –°–µ—Ç–∫–∞ –º–∞–≥–∞–∑–∏–Ω–∞ */
        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 24px;
            margin-top: 20px;
        }
        .product-card {
            background: var(--card-bg);
            border-radius: 30px;
            padding: 24px;
            border: 1px solid rgba(255,255,255,0.05);
            backdrop-filter: blur(5px);
            transition: 0.2s;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
        }
        .product-card:hover {
            transform: translateY(-8px);
            border-color: var(--neon-cyan);
            box-shadow: 0 15px 35px rgba(0,255,255,0.2);
        }
        .product-icon {
            width: 100px;
            height: 100px;
            background: rgba(78, 84, 245, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            color: var(--neon-cyan);
            margin-bottom: 20px;
            border: 2px solid transparent;
            transition: 0.2s;
        }
        .product-card:hover .product-icon {
            border-color: var(--neon-cyan);
            box-shadow: 0 0 30px var(--neon-cyan);
        }
        .product-name {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        .product-description {
            font-size: 14px;
            color: var(--text-dim);
            margin-bottom: 20px;
        }
        .product-price {
            font-size: 24px;
            font-weight: 700;
            color: var(--neon-green);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .btn-buy {
            width: 100%;
            padding: 14px;
            border-radius: 40px;
            background: linear-gradient(145deg, var(--neon-blue), #3a3fd4);
            border: none;
            color: white;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: 0.2s;
        }
        .btn-buy:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px var(--neon-blue);
        }
        .btn-buy:disabled {
            opacity: 0.5;
            pointer-events: none;
        }

        /* –¢–∞–±–ª–∏—Ü—ã */
        .table-container {
            background: var(--card-bg);
            border-radius: 30px;
            padding: 24px;
            border: 1px solid rgba(255,255,255,0.05);
            margin-bottom: 30px;
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }
        th {
            text-align: left;
            padding: 16px;
            background: rgba(0,0,0,0.3);
            color: var(--neon-cyan);
            font-weight: 600;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        td {
            padding: 16px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        tr:hover {
            background: rgba(255,255,255,0.03);
        }

        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(8px);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        .modal.active {
            display: flex;
        }
        .modal-content {
            background: var(--card-bg);
            border-radius: 40px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        .modal-header h2 {
            color: white;
        }
        .modal-close {
            background: none;
            border: none;
            font-size: 30px;
            color: var(--text-dim);
            cursor: pointer;
        }
        .modal-close:hover { color: white; }

        .form-group { margin-bottom: 20px; }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-dim);
            font-weight: 500;
        }
        .form-control {
            width: 100%;
            padding: 16px 20px;
            border-radius: 40px;
            border: none;
            background: rgba(0,0,0,0.4);
            color: white;
            font-size: 16px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .form-control:focus {
            outline: none;
            border-color: var(--neon-cyan);
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            bottom: 30px;
            right: 30px;
            padding: 18px 30px;
            border-radius: 60px;
            background: var(--card-bg);
            border-left: 6px solid var(--neon-green);
            color: white;
            font-weight: 600;
            z-index: 2000;
            display: none;
            animation: slideIn 0.3s;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px black;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        .notification.success { border-left-color: var(--neon-green); }
        .notification.error { border-left-color: var(--neon-pink); }
        .notification.warning { border-left-color: #f8961e; }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .header { flex-direction: column; text-align: center; }
            .tabs { flex-wrap: wrap; justify-content: center; }
            .tab-btn { flex: 1 1 auto; }
            .stats-grid { grid-template-columns: 1fr; }
            .shop-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="app">
            <!-- –≠–ö–†–ê–ù –í–•–û–î–ê -->
            <div id="loginScreen" class="screen active">
                <div class="header">
                    <div class="logo">
                        <div class="logo-icon"><i class="fas fa-rocket"></i></div>
                        <div class="logo-text">
                            <h1>–ö–≤–µ—Å—Ç 2026</h1>
                            <p>–ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å–µ–∫—Ç–æ—Ä</p>
                        </div>
                    </div>
                    <div class="version" style="color: var(--text-dim);">v3.0</div>
                </div>
                <div style="display: flex; justify-content: center; align-items: center; min-height: 70vh; padding: 30px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; width: 100%;">
                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –∫–æ–º–∞–Ω–¥—ã -->
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-icon" style="margin: 0 auto 20px;"><i class="fas fa-users"></i></div>
                            <h2 style="margin-bottom: 20px;">–£—á–∞—Å—Ç–Ω–∏–∫</h2>
                            <p style="margin-bottom: 30px; color: var(--text-dim);">–í–æ–π–¥–∏—Ç–µ –ø–æ –∫–æ–¥—É –∫–æ–º–∞–Ω–¥—ã</p>
                            <div class="form-group">
                                <input type="text" id="teamCodeInput" class="form-control" placeholder="–ö–æ–¥ –∫–æ–º–∞–Ω–¥—ã (6 —Å–∏–º–≤–æ–ª–æ–≤)" maxlength="6">
                            </div>
                            <button onclick="loginAsTeam()" class="btn btn-primary" style="width: 100%;">
                                <i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏
                            </button>
                        </div>
                        <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞ -->
                        <div class="stat-card" style="text-align: center;">
                            <div class="stat-icon" style="margin: 0 auto 20px;"><i class="fas fa-crown"></i></div>
                            <h2 style="margin-bottom: 20px;">–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä</h2>
                            <p style="margin-bottom: 30px; color: var(--text-dim);">–î–æ—Å—Ç—É–ø –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é</p>
                            <div class="form-group">
                                <input type="password" id="adminPasswordInput" class="form-control" placeholder="–ü–∞—Ä–æ–ª—å">
                            </div>
                            <button onclick="loginAsAdmin()" class="btn btn-success" style="width: 100%;">
                                <i class="fas fa-lock"></i> –í–æ–π—Ç–∏
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –≠–ö–†–ê–ù –£–ß–ê–°–¢–ù–ò–ö–ê (–ö–û–ú–ê–ù–î–´) -->
            <div id="teamScreen" class="screen">
                <div class="header">
                    <div class="logo">
                        <button onclick="logout()" class="btn btn-outline"><i class="fas fa-arrow-left"></i> –í—ã—Ö–æ–¥</button>
                        <div class="logo-icon"><i class="fas fa-galaxy"></i></div>
                        <div class="logo-text">
                            <h1 id="teamNameHeader">–ó–≤—ë–∑–¥–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞</h1>
                            <p>–ò–º–ø—É–ª—å—Å—ã: <span id="teamScoreHeader">0</span></p>
                        </div>
                    </div>
                    <div class="user-info">
                        <span class="impulse-badge"><i class="fas fa-bolt"></i> <span id="teamScoreBadge">0</span></span>
                        <button onclick="refreshTeamData()" class="btn"><i class="fas fa-sync-alt"></i></button>
                    </div>
                </div>

                <!-- –¢–∞–±—ã -->
                <div class="dashboard">
                    <div class="tabs">
                        <button class="tab-btn active" onclick="switchTeamTab('dashboard')">üìä –î–∞—à–±–æ—Ä–¥</button>
                        <button class="tab-btn" onclick="switchTeamTab('shop')">üõí –ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –º–∞–≥–∞–∑–∏–Ω</button>
                        <button class="tab-btn" onclick="switchTeamTab('inventory')">üì¶ –ú–æ–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
                    </div>

                    <!-- –í–∫–ª–∞–¥–∫–∞ –î–∞—à–±–æ—Ä–¥ -->
                    <div id="teamDashboardTab" style="display: block;">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-icon"><i class="fas fa-bolt"></i></div>
                                    <div class="stat-label">–ú–æ–∏ –∏–º–ø—É–ª—å—Å—ã</div>
                                </div>
                                <div class="stat-value" id="myScore">0</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-icon"><i class="fas fa-trophy"></i></div>
                                    <div class="stat-label">–ú–µ—Å—Ç–æ –≤ —Ä–µ–π—Ç–∏–Ω–≥–µ</div>
                                </div>
                                <div class="stat-value" id="myPosition">-</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header">
                                    <div class="stat-icon"><i class="fas fa-users"></i></div>
                                    <div class="stat-label">–í—Å–µ–≥–æ –∫–æ–º–∞–Ω–¥</div>
                                </div>
                                <div class="stat-value" id="totalTeamsCount">0</div>
                            </div>
                        </div>

                        <div class="table-container">
                            <h3 style="margin-bottom: 20px;"><i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏–π</h3>
                            <div id="historyTable">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        </div>

                        <div class="table-container">
                            <h3 style="margin-bottom: 20px;"><i class="fas fa-chart-line"></i> –†–µ–π—Ç–∏–Ω–≥ –∫–æ–º–∞–Ω–¥</h3>
                            <div id="ratingTable">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        </div>
                    </div>

                    <!-- –í–∫–ª–∞–¥–∫–∞ –ú–∞–≥–∞–∑–∏–Ω -->
                    <div id="teamShopTab" style="display: none;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                            <h2><i class="fas fa-store"></i> –ö–æ—Å–º–∏—á–µ—Å–∫–∏–µ –∑–¥–∞–Ω–∏—è –Æ–ø–∏—Ç–µ—Ä–∞</h2>
                            <span class="impulse-badge">–í–∞—à–∏ –∏–º–ø—É–ª—å—Å—ã: <span id="shopImpulseBalance">0</span></span>
                        </div>
                        <div id="shopItemsGrid" class="shop-grid">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</div>
                    </div>

                    <!-- –í–∫–ª–∞–¥–∫–∞ –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å -->
                    <div id="teamInventoryTab" style="display: none;">
                        <h2 style="margin-bottom: 20px;"><i class="fas fa-box"></i> –ú–æ–∏ –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏—è</h2>
                        <div id="inventoryGrid" class="shop-grid">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è...</div>
                    </div>
                </div>
            </div>

            <!-- –≠–ö–†–ê–ù –û–†–ì–ê–ù–ò–ó–ê–¢–û–†–ê -->
            <div id="adminScreen" class="screen">
                <div class="header">
                    <div class="logo">
                        <button onclick="logout()" class="btn btn-outline"><i class="fas fa-arrow-left"></i> –í—ã—Ö–æ–¥</button>
                        <div class="logo-icon"><i class="fas fa-crown"></i></div>
                        <div class="logo-text">
                            <h1>–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä</h1>
                            <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–∞–ª–∞–∫—Ç–∏–∫–æ–π</p>
                        </div>
                    </div>
                    <div class="user-info">
                        <span class="impulse-badge"><i class="fas fa-star"></i> –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø</span>
                        <button onclick="refreshAdminData()" class="btn"><i class="fas fa-sync-alt"></i></button>
                    </div>
                </div>

                <div class="dashboard">
                    <div class="tabs">
                        <button class="tab-btn active" onclick="switchAdminTab('teams')">üë• –ö–æ–º–∞–Ω–¥—ã</button>
                        <button class="tab-btn" onclick="switchAdminTab('shop')">üõí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–º</button>
                        <button class="tab-btn" onclick="switchAdminTab('stats')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                    </div>

                    <!-- –í–∫–ª–∞–¥–∫–∞ –ö–æ–º–∞–Ω–¥—ã (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–∞–º–∏ –∏ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –∏–º–ø—É–ª—å—Å–æ–≤) -->
                    <div id="adminTeamsTab" style="display: block;">
                        <div class="table-container">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3><i class="fas fa-users"></i> –í—Å–µ –∫–æ–º–∞–Ω–¥—ã</h3>
                                <button onclick="showAddTeamModal()" class="btn btn-success"><i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å</button>
                            </div>
                            <table id="allTeamsTable">
                                <thead><tr><th>ID</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–ò–º–ø—É–ª—å—Å—ã</th><th>–ö–æ–¥</th><th>–ö–æ–Ω—Ç–∞–∫—Ç</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead>
                                <tbody id="teamsTableBody"></tbody>
                            </table>
                        </div>

                        <div class="stats-grid">
                            <div class="table-container">
                                <h3><i class="fas fa-plus-circle"></i> –ë—ã—Å—Ç—Ä–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ</h3>
                                <select id="quickTeamSelect" class="form-control" style="margin-bottom: 15px;">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É</option>
                                </select>
                                <div style="display: grid; grid-template-columns: repeat(2,1fr); gap: 10px;">
                                    <button onclick="quickAddImpulses(10, '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å')" class="btn btn-success">+10</button>
                                    <button onclick="quickAddImpulses(20, '–ü–æ–±–µ–¥–∞')" class="btn btn-success">+20</button>
                                    <button onclick="quickAddImpulses(50, '–û—Å–æ–±–æ–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ')" class="btn btn-success">+50</button>
                                    <button onclick="quickAddImpulses(-5, '–ó–∞–º–µ—á–∞–Ω–∏–µ')" class="btn btn-danger">-5</button>
                                </div>
                            </div>
                            <div class="table-container">
                                <h3><i class="fas fa-edit"></i> –†—É—á–Ω–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ</h3>
                                <select id="manualTeamSelect" class="form-control" style="margin-bottom: 15px;">
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É</option>
                                </select>
                                <input type="number" id="pointsInput" class="form-control" placeholder="–ò–º–ø—É–ª—å—Å—ã" style="margin-bottom: 15px;">
                                <input type="text" id="reasonInput" class="form-control" placeholder="–ü—Ä–∏—á–∏–Ω–∞" style="margin-bottom: 15px;">
                                <button onclick="manualAddPoints()" class="btn btn-primary" style="width: 100%;">–ù–∞—á–∏—Å–ª–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>

                    <!-- –í–∫–ª–∞–¥–∫–∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–º (CRUD —Ç–æ–≤–∞—Ä–æ–≤) -->
                    <div id="adminShopTab" style="display: none;">
                        <div class="table-container">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3><i class="fas fa-boxes"></i> –¢–æ–≤–∞—Ä—ã –º–∞–≥–∞–∑–∏–Ω–∞</h3>
                                <button onclick="showAddItemModal()" class="btn btn-success"><i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                            </div>
                            <table id="itemsTable">
                                <thead><tr><th>ID</th><th>–ò–∫–æ–Ω–∫–∞</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th><th>–¶–µ–Ω–∞</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead>
                                <tbody id="itemsTableBody"></tbody>
                            </table>
                        </div>
                    </div>

                    <!-- –í–∫–ª–∞–¥–∫–∞ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
                    <div id="adminStatsTab" style="display: none;">
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-header"><div class="stat-icon"><i class="fas fa-users"></i></div></div>
                                <div class="stat-value" id="totalTeamsStat">0</div>
                                <div class="stat-label">–í—Å–µ–≥–æ –∫–æ–º–∞–Ω–¥</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header"><div class="stat-icon"><i class="fas fa-bolt"></i></div></div>
                                <div class="stat-value" id="totalImpulsesStat">0</div>
                                <div class="stat-label">–í—Å–µ–≥–æ –∏–º–ø—É–ª—å—Å–æ–≤</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-header"><div class="stat-icon"><i class="fas fa-shopping-cart"></i></div></div>
                                <div class="stat-value" id="totalPurchasesStat">0</div>
                                <div class="stat-label">–ü–æ–∫—É–ø–æ–∫</div>
                            </div>
                        </div>
                        <div class="table-container">
                            <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏</h3>
                            <div id="recentTransactionsAdmin">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê -->
    <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã -->
    <div id="addTeamModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ù–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞</h2>
                <button class="modal-close" onclick="closeModal('addTeamModal')">&times;</button>
            </div>
            <div class="form-group"><label>–ù–∞–∑–≤–∞–Ω–∏–µ</label><input type="text" id="newTeamName" class="form-control"></div>
            <div class="form-group"><label>–ö–æ–¥ (6 —Å–∏–º–≤–æ–ª–æ–≤)</label><input type="text" id="newTeamCode" class="form-control" maxlength="6"></div>
            <div class="form-group"><label>–ö–æ–Ω—Ç–∞–∫—Ç</label><input type="text" id="newTeamContact" class="form-control"></div>
            <button onclick="addTeam()" class="btn btn-success" style="width:100%;">–°–æ–∑–¥–∞—Ç—å</button>
        </div>
    </div>
    <!-- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã -->
    <div id="editTeamModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É</h2>
                <button class="modal-close" onclick="closeModal('editTeamModal')">&times;</button>
            </div>
            <input type="hidden" id="editTeamId">
            <div class="form-group"><label>–ù–∞–∑–≤–∞–Ω–∏–µ</label><input type="text" id="editTeamName" class="form-control"></div>
            <div class="form-group"><label>–ö–æ–¥</label><input type="text" id="editTeamCode" class="form-control" maxlength="6"></div>
            <div class="form-group"><label>–ö–æ–Ω—Ç–∞–∫—Ç</label><input type="text" id="editTeamContact" class="form-control"></div>
            <div style="display:flex; gap:10px;">
                <button onclick="updateTeam()" class="btn btn-primary" style="flex:1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button onclick="deleteTeam()" class="btn btn-danger">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    </div>
    <!-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ -->
    <div id="addItemModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h2>
                <button class="modal-close" onclick="closeModal('addItemModal')">&times;</button>
            </div>
            <div class="form-group"><label>–ù–∞–∑–≤–∞–Ω–∏–µ</label><input type="text" id="newItemName" class="form-control"></div>
            <div class="form-group"><label>–û–ø–∏—Å–∞–Ω–∏–µ</label><input type="text" id="newItemDesc" class="form-control"></div>
            <div class="form-group"><label>–¶–µ–Ω–∞ (–∏–º–ø—É–ª—å—Å—ã)</label><input type="number" id="newItemPrice" class="form-control"></div>
            <div class="form-group"><label>–ò–∫–æ–Ω–∫–∞ (–∫–ª–∞—Å—Å FontAwesome, –Ω–∞–ø—Ä–∏–º–µ—Ä "fa-solid fa-meteor")</label><input type="text" id="newItemIcon" class="form-control" value="fa-solid fa-question"></div>
            <button onclick="addItem()" class="btn btn-success" style="width:100%;">–î–æ–±–∞–≤–∏—Ç—å</button>
        </div>
    </div>
    <!-- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ -->
    <div id="editItemModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä</h2>
                <button class="modal-close" onclick="closeModal('editItemModal')">&times;</button>
            </div>
            <input type="hidden" id="editItemId">
            <div class="form-group"><label>–ù–∞–∑–≤–∞–Ω–∏–µ</label><input type="text" id="editItemName" class="form-control"></div>
            <div class="form-group"><label>–û–ø–∏—Å–∞–Ω–∏–µ</label><input type="text" id="editItemDesc" class="form-control"></div>
            <div class="form-group"><label>–¶–µ–Ω–∞</label><input type="number" id="editItemPrice" class="form-control"></div>
            <div class="form-group"><label>–ò–∫–æ–Ω–∫–∞</label><input type="text" id="editItemIcon" class="form-control"></div>
            <div style="display:flex; gap:10px;">
                <button onclick="updateItem()" class="btn btn-primary" style="flex:1;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                <button onclick="deleteItem()" class="btn btn-danger">–£–¥–∞–ª–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div id="notification" class="notification"></div>

    <script>
        // ================= –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø =================
        const CONFIG = {
            SCRIPT_URL: 'https://script.google.com/macros/s/AKfycbyMzzzbBeHUOSORS5GvT4QLRMEnHTMfpyX55yhCtZdWZHBgizEvgewt1Hfu534oIOctcg/exec', // –ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –°–í–û–ô URL
            ADMIN_PASSWORD: 'org2026',
            REFRESH_INTERVAL: 30000
        };

        // ================= –°–û–°–¢–û–Ø–ù–ò–ï =================
        let currentState = {
            team: null,               // —Ç–µ–∫—É—â–∞—è –∫–æ–º–∞–Ω–¥–∞
            isAdmin: false,
            adminPassword: '',
            allTeams: [],
            allItems: [],
            purchases: [],
            transactions: [],
            rating: []
        };

        // ================= –û–ë–©–ò–ï –§–£–ù–ö–¶–ò–ò =================
        function showNotification(message, type = 'info') {
            const notif = document.getElementById('notification');
            notif.textContent = message;
            notif.className = `notification ${type}`;
            notif.style.display = 'block';
            setTimeout(() => { notif.style.display = 'none'; }, 3000);
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // ================= –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø =================
        document.addEventListener('DOMContentLoaded', () => {
            const savedTeam = localStorage.getItem('team');
            const savedAdmin = localStorage.getItem('admin') === 'true';
            const savedPwd = localStorage.getItem('adminPwd');
            if (savedTeam) {
                currentState.team = JSON.parse(savedTeam);
                showScreen('teamScreen');
                loadTeamData();
                startAutoRefresh();
            } else if (savedAdmin && savedPwd) {
                currentState.isAdmin = true;
                currentState.adminPassword = savedPwd;
                showScreen('adminScreen');
                loadAdminData();
                startAutoRefresh();
            }
        });

        function loginAsTeam() {
            const code = document.getElementById('teamCodeInput').value.trim().toUpperCase();
            if (!code) return showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥', 'error');
            fetch(`${CONFIG.SCRIPT_URL}?action=getTeamByCode&code=${encodeURIComponent(code)}`)
                .then(r => r.json())
                .then(res => {
                    if (res.success && res.data.team) {
                        currentState.team = res.data.team;
                        localStorage.setItem('team', JSON.stringify(currentState.team));
                        showScreen('teamScreen');
                        loadTeamData();
                        startAutoRefresh();
                        showNotification(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${currentState.team.name}!`, 'success');
                    } else {
                        showNotification('–ö–æ–º–∞–Ω–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                    }
                })
                .catch(() => showNotification('–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è', 'error'));
        }

        function loginAsAdmin() {
            const pwd = document.getElementById('adminPasswordInput').value;
            if (!pwd) return showNotification('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å', 'error');
            fetch(CONFIG.SCRIPT_URL, {
                method: 'POST',
                body: new URLSearchParams({ action: 'checkPassword', password: pwd })
            })
            .then(r => r.json())
            .then(res => {
                if (res.success && res.data.valid) {
                    currentState.isAdmin = true;
                    currentState.adminPassword = pwd;
                    localStorage.setItem('admin', 'true');
                    localStorage.setItem('adminPwd', pwd);
                    showScreen('adminScreen');
                    loadAdminData();
                    startAutoRefresh();
                    showNotification('–î–æ—Å—Ç—É–ø –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞', 'success');
                } else {
                    showNotification('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å', 'error');
                }
            })
            .catch(() => showNotification('–û—à–∏–±–∫–∞', 'error'));
        }

        function logout() {
            currentState.team = null;
            currentState.isAdmin = false;
            currentState.adminPassword = '';
            localStorage.removeItem('team');
            localStorage.removeItem('admin');
            localStorage.removeItem('adminPwd');
            stopAutoRefresh();
            showScreen('loginScreen');
        }

        // ================= –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• –ö–û–ú–ê–ù–î–´ =================
        async function loadTeamData() {
            if (!currentState.team) return;
            try {
                const [ratingRes, historyRes, itemsRes, invRes] = await Promise.all([
                    fetch(`${CONFIG.SCRIPT_URL}?action=getRating`),
                    fetch(`${CONFIG.SCRIPT_URL}?action=getTransactions&teamId=${currentState.team.id}`),
                    fetch(`${CONFIG.SCRIPT_URL}?action=getShopItems`),
                    fetch(`${CONFIG.SCRIPT_URL}?action=getTeamInventory&teamId=${currentState.team.id}`)
                ]);

                const ratingData = await ratingRes.json();
                const historyData = await historyRes.json();
                const itemsData = await itemsRes.json();
                const invData = await invRes.json();

                if (ratingData.success) {
                    currentState.rating = ratingData.data.rating || [];
                    const updated = currentState.rating.find(t => t.id == currentState.team.id);
                    if (updated) {
                        currentState.team.score = updated.score || 0;
                        currentState.team.name = updated.name;
                        localStorage.setItem('team', JSON.stringify(currentState.team));
                    }
                }
                if (historyData.success) currentState.transactions = historyData.data.transactions || [];
                if (itemsData.success) currentState.allItems = itemsData.data.items || [];
                if (invData.success) currentState.purchases = invData.data.items || [];

                updateTeamUI();
            } catch (e) {
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏', 'error');
            }
        }

        function updateTeamUI() {
            if (!currentState.team) return;
            // –®–∞–ø–∫–∞
            document.getElementById('teamNameHeader').textContent = currentState.team.name;
            document.getElementById('teamScoreHeader').textContent = currentState.team.score;
            document.getElementById('teamScoreBadge').textContent = currentState.team.score;
            // –î–∞—à–±–æ—Ä–¥
            document.getElementById('myScore').textContent = currentState.team.score;
            const pos = currentState.rating.findIndex(t => t.id == currentState.team.id) + 1;
            document.getElementById('myPosition').textContent = pos > 0 ? pos : '-';
            document.getElementById('totalTeamsCount').textContent = currentState.rating.length;

            // –ò—Å—Ç–æ—Ä–∏—è
            let histHtml = '<table><tr><th>–í—Ä–µ–º—è</th><th>–ò–º–ø—É–ª—å—Å—ã</th><th>–ü—Ä–∏—á–∏–Ω–∞</th></tr>';
            if (currentState.transactions.length) {
                currentState.transactions.slice(0,10).forEach(t => {
                    histHtml += `<tr><td>${new Date(t.timestamp).toLocaleString()}</td><td>${t.points>0?'+':''}${t.points}</td><td>${t.reason}</td></tr>`;
                });
            } else histHtml += '<tr><td colspan="3">–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏</td></tr>';
            histHtml += '</table>';
            document.getElementById('historyTable').innerHTML = histHtml;

            // –†–µ–π—Ç–∏–Ω–≥
            let rateHtml = '<table><tr><th>–ú–µ—Å—Ç–æ</th><th>–ö–æ–º–∞–Ω–¥–∞</th><th>–ò–º–ø—É–ª—å—Å—ã</th></tr>';
            currentState.rating.slice(0,15).forEach((t,i) => {
                rateHtml += `<tr ${t.id==currentState.team.id?'style="background:rgba(78,84,245,0.3)"':''}><td>${i+1}</td><td>${t.name}</td><td>${t.score}</td></tr>`;
            });
            rateHtml += '</table>';
            document.getElementById('ratingTable').innerHTML = rateHtml;

            // –ú–∞–≥–∞–∑–∏–Ω: –±–∞–ª–∞–Ω—Å –∏ —Ç–æ–≤–∞—Ä—ã
            document.getElementById('shopImpulseBalance').textContent = currentState.team.score;
            let shopHtml = '';
            if (currentState.allItems.length) {
                currentState.allItems.forEach(item => {
                    const alreadyOwned = currentState.purchases.some(p => p.id == item.id);
                    shopHtml += `
                        <div class="product-card">
                            <div class="product-icon"><i class="${item.icon}"></i></div>
                            <div class="product-name">${item.name}</div>
                            <div class="product-description">${item.description}</div>
                            <div class="product-price"><i class="fas fa-bolt"></i> ${item.price}</div>
                            <button class="btn-buy" onclick="buyItem(${item.id})" ${alreadyOwned || currentState.team.score < item.price ? 'disabled' : ''}>
                                ${alreadyOwned ? '–£–∂–µ –∫—É–ø–ª–µ–Ω–æ' : '–ö—É–ø–∏—Ç—å'}
                            </button>
                        </div>
                    `;
                });
            } else shopHtml = '<p>–¢–æ–≤–∞—Ä—ã –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</p>';
            document.getElementById('shopItemsGrid').innerHTML = shopHtml;

            // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å
            let invHtml = '';
            if (currentState.purchases.length) {
                currentState.purchases.forEach(item => {
                    invHtml += `
                        <div class="product-card">
                            <div class="product-icon"><i class="${item.icon}"></i></div>
                            <div class="product-name">${item.name}</div>
                            <div class="product-description">${item.description}</div>
                            <div style="color: var(--neon-green);"><i class="fas fa-check-circle"></i> –ü—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–æ</div>
                        </div>
                    `;
                });
            } else invHtml = '<p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∫—É–ø–ª–µ–Ω–Ω—ã—Ö –∑–¥–∞–Ω–∏–π.</p>';
            document.getElementById('inventoryGrid').innerHTML = invHtml;
        }

        // –ü–æ–∫—É–ø–∫–∞ —Ç–æ–≤–∞—Ä–∞
        async function buyItem(itemId) {
            if (!currentState.team) return;
            const teamId = currentState.team.id;
            try {
                const formData = new FormData();
                formData.append('action', 'buyItem');
                formData.append('teamId', teamId);
                formData.append('itemId', itemId);
                formData.append('password', CONFIG.ADMIN_PASSWORD); // –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞, –Ω–æ —É –Ω–∞—Å –ø–æ–∫—É–ø–∫–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–∞—Ä–æ–ª—è, –Ω–æ –¥–æ–±–∞–≤–∏–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

                const res = await fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: formData });
                const result = await res.json();
                if (result.success) {
                    showNotification('–ü–æ–∫—É–ø–∫–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–∞!', 'success');
                    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
                    currentState.team.score = result.data.newScore;
                    localStorage.setItem('team', JSON.stringify(currentState.team));
                    loadTeamData(); // –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–º –≤—Å—ë (–∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –æ–±–Ω–æ–≤–∏—Ç—Å—è)
                } else {
                    showNotification(result.data.error || '–û—à–∏–±–∫–∞', 'error');
                }
            } catch (e) {
                showNotification('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', 'error');
            }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤ —É—á–∞—Å—Ç–Ω–∏–∫–∞
        window.switchTeamTab = (tab) => {
            document.querySelectorAll('#teamScreen .tab-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('teamDashboardTab').style.display = tab === 'dashboard' ? 'block' : 'none';
            document.getElementById('teamShopTab').style.display = tab === 'shop' ? 'block' : 'none';
            document.getElementById('teamInventoryTab').style.display = tab === 'inventory' ? 'block' : 'none';
            if (tab === 'shop' || tab === 'inventory') loadTeamData(); // –ø–æ–¥–≥—Ä—É–∂–∞–µ–º —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ
        };

        // ================= –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• –û–†–ì–ê–ù–ò–ó–ê–¢–û–†–ê =================
        async function loadAdminData() {
            try {
                const [teamsRes, itemsRes, transRes] = await Promise.all([
                    fetch(`${CONFIG.SCRIPT_URL}?action=getTeams`),
                    fetch(`${CONFIG.SCRIPT_URL}?action=getShopItems`),
                    fetch(`${CONFIG.SCRIPT_URL}?action=getTransactions`)
                ]);
                const teamsData = await teamsRes.json();
                const itemsData = await itemsRes.json();
                const transData = await transRes.json();

                if (teamsData.success) currentState.allTeams = teamsData.data.teams || [];
                if (itemsData.success) currentState.allItems = itemsData.data.items || [];
                if (transData.success) currentState.transactions = transData.data.transactions || [];

                updateAdminUI();
            } catch (e) {
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö', 'error');
            }
        }

        function updateAdminUI() {
            // –¢–∞–±–ª–∏—Ü–∞ –∫–æ–º–∞–Ω–¥
            let teamsHtml = '';
            if (currentState.allTeams.length) {
                currentState.allTeams.forEach(t => {
                    teamsHtml += `<tr>
                        <td>${t.id}</td>
                        <td>${t.name}</td>
                        <td>${t.score}</td>
                        <td>${t.code}</td>
                        <td>${t.contact || '-'}</td>
                        <td>
                            <button class="btn btn-primary" onclick="openEditTeamModal(${t.id})" style="padding:6px 12px;"><i class="fas fa-edit"></i></button>
                        </td>
                    </tr>`;
                });
            } else teamsHtml = '<tr><td colspan="6">–ù–µ—Ç –∫–æ–º–∞–Ω–¥</td></tr>';
            document.getElementById('teamsTableBody').innerHTML = teamsHtml;

            // –°–µ–ª–µ–∫—Ç—ã –¥–ª—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è
            let options = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É</option>';
            currentState.allTeams.forEach(t => options += `<option value="${t.id}">${t.name} (${t.score})</option>`);
            document.getElementById('quickTeamSelect').innerHTML = options;
            document.getElementById('manualTeamSelect').innerHTML = options;

            // –¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤
            let itemsHtml = '';
            if (currentState.allItems.length) {
                currentState.allItems.forEach(i => {
                    itemsHtml += `<tr>
                        <td>${i.id}</td>
                        <td><i class="${i.icon}"></i></td>
                        <td>${i.name}</td>
                        <td>${i.description}</td>
                        <td>${i.price}</td>
                        <td>
                            <button class="btn btn-primary" onclick="openEditItemModal(${i.id})" style="padding:6px 12px;"><i class="fas fa-edit"></i></button>
                        </td>
                    </tr>`;
                });
            } else itemsHtml = '<tr><td colspan="6">–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</td></tr>';
            document.getElementById('itemsTableBody').innerHTML = itemsHtml;

            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            document.getElementById('totalTeamsStat').textContent = currentState.allTeams.length;
            const totalImp = currentState.allTeams.reduce((acc, t) => acc + (t.score || 0), 0);
            document.getElementById('totalImpulsesStat').textContent = totalImp;
            document.getElementById('totalPurchasesStat').textContent = '?'; // –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Å—á—ë—Ç

            // –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
            let transHtml = '<table><tr><th>–í—Ä–µ–º—è</th><th>–ö–æ–º–∞–Ω–¥–∞</th><th>–ò–º–ø—É–ª—å—Å—ã</th><th>–ü—Ä–∏—á–∏–Ω–∞</th></tr>';
            if (currentState.transactions.length) {
                currentState.transactions.slice(0,10).forEach(t => {
                    const team = currentState.allTeams.find(tt => tt.id == t.teamId);
                    transHtml += `<tr><td>${new Date(t.timestamp).toLocaleString()}</td><td>${team ? team.name : t.teamId}</td><td>${t.points}</td><td>${t.reason}</td></tr>`;
                });
            } else transHtml += '<tr><td colspan="4">–ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π</td></tr>';
            transHtml += '</table>';
            document.getElementById('recentTransactionsAdmin').innerHTML = transHtml;
        }

        // –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ –∏–º–ø—É–ª—å—Å–æ–≤ (–æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä)
        function quickAddImpulses(points, reason) {
            const teamId = document.getElementById('quickTeamSelect').value;
            if (!teamId) return showNotification('–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É', 'warning');
            document.getElementById('manualTeamSelect').value = teamId;
            document.getElementById('pointsInput').value = points;
            document.getElementById('reasonInput').value = reason;
            manualAddPoints();
        }

        async function manualAddPoints() {
            const teamId = document.getElementById('manualTeamSelect').value;
            const points = parseInt(document.getElementById('pointsInput').value);
            const reason = document.getElementById('reasonInput').value.trim();
            if (!teamId || isNaN(points) || !reason) return showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');

            const formData = new FormData();
            formData.append('action', 'addPoints');
            formData.append('teamId', teamId);
            formData.append('points', points);
            formData.append('reason', reason);
            formData.append('moderator', '–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä');
            formData.append('password', currentState.adminPassword);

            try {
                const res = await fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: formData });
                const result = await res.json();
                if (result.success) {
                    showNotification('–ù–∞—á–∏—Å–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ', 'success');
                    document.getElementById('pointsInput').value = '';
                    document.getElementById('reasonInput').value = '';
                    loadAdminData();
                    // –ï—Å–ª–∏ —ç—Ç–æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ –¥–ª—è —Ç–µ–∫—É—â–µ–π –∫–æ–º–∞–Ω–¥—ã (–µ—Å–ª–∏ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä –µ—â—ë –∏ –ø–æ–¥ —Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥–æ–π –∑–∞–ª–æ–≥–∏–Ω–µ–Ω), –æ–±–Ω–æ–≤–∏–º –∏ –µ—ë
                    if (currentState.team && currentState.team.id == teamId) {
                        currentState.team.score += points;
                        localStorage.setItem('team', JSON.stringify(currentState.team));
                    }
                } else {
                    showNotification(result.data.error || '–û—à–∏–±–∫–∞', 'error');
                }
            } catch (e) { showNotification('–û—à–∏–±–∫–∞ —Å–µ—Ç–∏', 'error'); }
        }

        // CRUD –∫–æ–º–∞–Ω–¥—ã
        function showAddTeamModal() { document.getElementById('addTeamModal').classList.add('active'); }
        async function addTeam() {
            const name = document.getElementById('newTeamName').value.trim();
            const code = document.getElementById('newTeamCode').value.trim().toUpperCase();
            const contact = document.getElementById('newTeamContact').value.trim();
            if (!name || !code) return showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ –∫–æ–¥', 'error');
            if (code.length !== 6) return showNotification('–ö–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 6 —Å–∏–º–≤–æ–ª–æ–≤', 'error');

            const formData = new FormData();
            formData.append('action', 'addTeam');
            formData.append('name', name);
            formData.append('code', code);
            formData.append('contact', contact);
            formData.append('password', currentState.adminPassword);

            try {
                const res = await fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: formData });
                const result = await res.json();
                if (result.success) {
                    showNotification('–ö–æ–º–∞–Ω–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞', 'success');
                    closeModal('addTeamModal');
                    document.getElementById('newTeamName').value = '';
                    document.getElementById('newTeamCode').value = '';
                    document.getElementById('newTeamContact').value = '';
                    loadAdminData();
                } else {
                    showNotification(result.data.error || '–û—à–∏–±–∫–∞', 'error');
                }
            } catch (e) { showNotification('–û—à–∏–±–∫–∞', 'error'); }
        }

        function openEditTeamModal(id) {
            const team = currentState.allTeams.find(t => t.id == id);
            if (team) {
                document.getElementById('editTeamId').value = team.id;
                document.getElementById('editTeamName').value = team.name;
                document.getElementById('editTeamCode').value = team.code;
                document.getElementById('editTeamContact').value = team.contact || '';
                document.getElementById('editTeamModal').classList.add('active');
            }
        }
        async function updateTeam() {
            const id = document.getElementById('editTeamId').value;
            const name = document.getElementById('editTeamName').value.trim();
            const code = document.getElementById('editTeamCode').value.trim().toUpperCase();
            const contact = document.getElementById('editTeamContact').value.trim();
            if (!name || !code) return showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è', 'error');
            const formData = new FormData();
            formData.append('action', 'updateTeam');
            formData.append('teamId', id);
            formData.append('name', name);
            formData.append('code', code);
            formData.append('contact', contact);
            formData.append('password', currentState.adminPassword);
            try {
                const res = await fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: formData });
                const result = await res.json();
                if (result.success) {
                    showNotification('–û–±–Ω–æ–≤–ª–µ–Ω–æ', 'success');
                    closeModal('editTeamModal');
                    loadAdminData();
                    if (currentState.team && currentState.team.id == id) {
                        currentState.team.name = name;
                        currentState.team.code = code;
                        localStorage.setItem('team', JSON.stringify(currentState.team));
                    }
                } else {
                    showNotification(result.data.error || '–û—à–∏–±–∫–∞', 'error');
                }
            } catch (e) { showNotification('–û—à–∏–±–∫–∞', 'error'); }
        }
        async function deleteTeam() {
            const id = document.getElementById('editTeamId').value;
            if (!confirm('–£–¥–∞–ª–∏—Ç—å –∫–æ–º–∞–Ω–¥—É? –≠—Ç–æ —É–¥–∞–ª–∏—Ç –≤—Å–µ –µ—ë –¥–∞–Ω–Ω—ã–µ.')) return;
            const formData = new FormData();
            formData.append('action', 'deleteTeam');
            formData.append('teamId', id);
            formData.append('password', currentState.adminPassword);
            try {
                const res = await fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: formData });
                const result = await res.json();
                if (result.success) {
                    showNotification('–ö–æ–º–∞–Ω–¥–∞ —É–¥–∞–ª–µ–Ω–∞', 'success');
                    closeModal('editTeamModal');
                    loadAdminData();
                } else {
                    showNotification(result.data.error || '–û—à–∏–±–∫–∞', 'error');
                }
            } catch (e) { showNotification('–û—à–∏–±–∫–∞', 'error'); }
        }

        // CRUD —Ç–æ–≤–∞—Ä–æ–≤
        function showAddItemModal() { document.getElementById('addItemModal').classList.add('active'); }
        async function addItem() {
            const name = document.getElementById('newItemName').value.trim();
            const desc = document.getElementById('newItemDesc').value.trim();
            const price = parseInt(document.getElementById('newItemPrice').value);
            const icon = document.getElementById('newItemIcon').value.trim();
            if (!name || !price) return showNotification('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ü–µ–Ω—É', 'error');
            const formData = new FormData();
            formData.append('action', 'addItem');
            formData.append('name', name);
            formData.append('description', desc);
            formData.append('price', price);
            formData.append('icon', icon);
            formData.append('password', currentState.adminPassword);
            try {
                const res = await fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: formData });
                const result = await res.json();
                if (result.success) {
                    showNotification('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω', 'success');
                    closeModal('addItemModal');
                    document.getElementById('newItemName').value = '';
                    document.getElementById('newItemDesc').value = '';
                    document.getElementById('newItemPrice').value = '';
                    document.getElementById('newItemIcon').value = 'fa-solid fa-question';
                    loadAdminData();
                } else {
                    showNotification(result.data.error || '–û—à–∏–±–∫–∞', 'error');
                }
            } catch (e) { showNotification('–û—à–∏–±–∫–∞', 'error'); }
        }
        function openEditItemModal(id) {
            const item = currentState.allItems.find(i => i.id == id);
            if (item) {
                document.getElementById('editItemId').value = item.id;
                document.getElementById('editItemName').value = item.name;
                document.getElementById('editItemDesc').value = item.description;
                document.getElementById('editItemPrice').value = item.price;
                document.getElementById('editItemIcon').value = item.icon;
                document.getElementById('editItemModal').classList.add('active');
            }
        }
        async function updateItem() {
            const id = document.getElementById('editItemId').value;
            const name = document.getElementById('editItemName').value.trim();
            const desc = document.getElementById('editItemDesc').value.trim();
            const price = parseInt(document.getElementById('editItemPrice').value);
            const icon = document.getElementById('editItemIcon').value.trim();
            if (!name || !price) return showNotification('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è', 'error');
            const formData = new FormData();
            formData.append('action', 'updateItem');
            formData.append('itemId', id);
            formData.append('name', name);
            formData.append('description', desc);
            formData.append('price', price);
            formData.append('icon', icon);
            formData.append('password', currentState.adminPassword);
            try {
                const res = await fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: formData });
                const result = await res.json();
                if (result.success) {
                    showNotification('–û–±–Ω–æ–≤–ª–µ–Ω–æ', 'success');
                    closeModal('editItemModal');
                    loadAdminData();
                } else {
                    showNotification(result.data.error || '–û—à–∏–±–∫–∞', 'error');
                }
            } catch (e) { showNotification('–û—à–∏–±–∫–∞', 'error'); }
        }
        async function deleteItem() {
            const id = document.getElementById('editItemId').value;
            if (!confirm('–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä?')) return;
            const formData = new FormData();
            formData.append('action', 'deleteItem');
            formData.append('itemId', id);
            formData.append('password', currentState.adminPassword);
            try {
                const res = await fetch(CONFIG.SCRIPT_URL, { method: 'POST', body: formData });
                const result = await res.json();
                if (result.success) {
                    showNotification('–¢–æ–≤–∞—Ä —É–¥–∞–ª—ë–Ω', 'success');
                    closeModal('editItemModal');
                    loadAdminData();
                } else {
                    showNotification(result.data.error || '–û—à–∏–±–∫–∞', 'error');
                }
            } catch (e) { showNotification('–û—à–∏–±–∫–∞', 'error'); }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–∞
        window.switchAdminTab = (tab) => {
            document.querySelectorAll('#adminScreen .tab-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('adminTeamsTab').style.display = tab === 'teams' ? 'block' : 'none';
            document.getElementById('adminShopTab').style.display = tab === 'shop' ? 'block' : 'none';
            document.getElementById('adminStatsTab').style.display = tab === 'stats' ? 'block' : 'none';
            if (tab === 'shop' || tab === 'stats') loadAdminData();
        };

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        window.refreshTeamData = loadTeamData;
        window.refreshAdminData = loadAdminData;

        // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        let refreshInterval;
        function startAutoRefresh() {
            stopAutoRefresh();
            refreshInterval = setInterval(() => {
                if (currentState.team) loadTeamData();
                else if (currentState.isAdmin) loadAdminData();
            }, CONFIG.REFRESH_INTERVAL);
        }
        function stopAutoRefresh() { if (refreshInterval) clearInterval(refreshInterval); }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è onclick
        window.loginAsTeam = loginAsTeam;
        window.loginAsAdmin = loginAsAdmin;
        window.logout = logout;
        window.buyItem = buyItem;
        window.quickAddImpulses = quickAddImpulses;
        window.manualAddPoints = manualAddPoints;
        window.showAddTeamModal = showAddTeamModal;
        window.addTeam = addTeam;
        window.openEditTeamModal = openEditTeamModal;
        window.updateTeam = updateTeam;
        window.deleteTeam = deleteTeam;
        window.showAddItemModal = showAddItemModal;
        window.addItem = addItem;
        window.openEditItemModal = openEditItemModal;
        window.updateItem = updateItem;
        window.deleteItem = deleteItem;
        window.closeModal = closeModal;
    </script>
</body>
</html>







