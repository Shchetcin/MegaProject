<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–≤–µ—Å—Ç 2026 ‚Äì –ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –º–∞–≥–∞–∑–∏–Ω</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Arial', sans-serif;
        }

        :root {
            --space-dark: #0b0d1e;
            --space-purple: #1a1a3a;
            --neon-blue: #4e54f5;
            --neon-cyan: #3dc2ec;
            --neon-pink: #f72585;
            --neon-green: #06d6a0;
            --star-color: rgba(255, 255, 255, 0.9);
            --card-bg: rgba(20, 25, 45, 0.9);
            --text-light: #f0f0f0;
            --text-dim: #aaa;
        }

        body {
            background: radial-gradient(ellipse at top, #1a1a3a, #0a0a1a);
            min-height: 100vh;
            padding: 16px;
            position: relative;
            overflow-x: hidden;
        }

        /* –£–ª—É—á—à–µ–Ω–Ω–æ–µ –∑–≤—ë–∑–¥–Ω–æ–µ –Ω–µ–±–æ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π –∏ –ø–ª–∞–Ω–µ—Ç–æ–π */
        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: transparent;
            background-image: 
                radial-gradient(2px 2px at 10px 20px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 30px 70px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(3px 3px at 80px 40px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(1px 1px at 150px 180px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 250px 300px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(3px 3px at 350px 150px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 450px 500px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 550px 700px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(3px 3px at 650px 400px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(1px 1px at 750px 900px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 850px 200px, var(--star-color), rgba(0,0,0,0)),
                radial-gradient(2px 2px at 950px 600px, var(--star-color), rgba(0,0,0,0)),
                /* –î–æ–±–∞–≤–ª–µ–Ω–æ –±–æ–ª—å—à–µ –∑–≤—ë–∑–¥ */
                radial-gradient(4px 4px at 120px 340px, #fff, rgba(0,0,0,0)),
                radial-gradient(3px 3px at 520px 880px, #ffe9a0, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 820px 120px, #b0e0ff, rgba(0,0,0,0)),
                radial-gradient(5px 5px at 1120px 650px, #fff, rgba(0,0,0,0)),
                radial-gradient(3px 3px at 1320px 250px, #f0e68c, rgba(0,0,0,0)),
                radial-gradient(4px 4px at 90px 950px, #b0c4de, rgba(0,0,0,0)),
                radial-gradient(2px 2px at 650px 1150px, #fff, rgba(0,0,0,0)),
                radial-gradient(3px 3px at 1400px 450px, #ffe4e1, rgba(0,0,0,0));
            background-repeat: repeat;
            pointer-events: none;
            z-index: -1;
            animation: twinkle 4s infinite alternate;
        }

        /* –ü–ª–∞–Ω–µ—Ç–∞ (—Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Æ–ø–∏—Ç–µ—Ä–∞) */
        body::after {
            content: '';
            position: fixed;
            bottom: -100px;
            right: -100px;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle at 30% 30%, #c98b4b, #6b4423, #3a2819);
            border-radius: 50%;
            box-shadow: 0 0 80px #ffb347, inset -30px -30px 60px #3a2819, inset 30px 30px 60px #e0ac69;
            z-index: -2;
            opacity: 0.4;
            filter: blur(4px);
            animation: float 20s infinite ease-in-out;
        }

        @keyframes twinkle {
            0% { opacity: 0.7; }
            50% { opacity: 1; }
            100% { opacity: 0.8; }
        }

        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(-30px, -30px) rotate(5deg); }
            100% { transform: translate(0, 0) rotate(0deg); }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .app {
            background: rgba(10, 15, 30, 0.7);
            backdrop-filter: blur(12px);
            border-radius: 40px;
            border: 1px solid rgba(255,255,255,0.1);
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            overflow: hidden;
            min-height: 90vh;
            color: var(--text-light);
        }

        .screen { display: none; }
        .screen.active { display: block; animation: fadeIn 0.5s ease; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 20px 30px; background: rgba(0,0,0,0.3);
            border-bottom: 1px solid rgba(255,255,255,0.1); flex-wrap: wrap; gap: 15px;
        }

        .logo { display: flex; align-items: center; gap: 20px; }
        .logo-icon {
            width: 50px; height: 50px; background: linear-gradient(145deg, var(--neon-blue), var(--neon-cyan));
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 28px; color: white; box-shadow: 0 0 20px var(--neon-blue);
        }
        .logo-text h1 {
            font-size: 26px; font-weight: 600; background: linear-gradient(135deg, #fff, #b0b0ff);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .logo-text p { font-size: 14px; color: var(--text-dim); }

        .user-info {
            display: flex; align-items: center; gap: 20px; background: rgba(0,0,0,0.5);
            padding: 8px 20px; border-radius: 40px; border: 1px solid rgba(255,255,255,0.15);
        }
        .impulse-badge {
            background: linear-gradient(145deg, var(--neon-green), #0a9); color: #000;
            font-weight: bold; padding: 6px 16px; border-radius: 30px; font-size: 16px;
            display: flex; align-items: center; gap: 8px; box-shadow: 0 0 15px var(--neon-green);
        }

        .btn {
            padding: 12px 28px; border: none; border-radius: 40px; font-size: 16px;
            font-weight: 600; cursor: pointer; transition: all 0.2s;
            display: inline-flex; align-items: center; justify-content: center; gap: 8px;
            background: rgba(255,255,255,0.05); color: white; border: 1px solid rgba(255,255,255,0.1);
            backdrop-filter: blur(5px);
        }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 10px 25px rgba(0,0,0,0.5); border-color: var(--neon-cyan); }
        .btn-primary { background: linear-gradient(145deg, var(--neon-blue), #3a3fd4); border: none; }
        .btn-success { background: linear-gradient(145deg, var(--neon-green), #059669); border: none; }
        .btn-danger { background: linear-gradient(145deg, var(--neon-pink), #c41e6b); border: none; }
        .btn-outline { background: transparent; border: 2px solid var(--neon-cyan); color: var(--neon-cyan); }

        .tabs {
            display: flex; gap: 5px; background: rgba(0,0,0,0.3); padding: 8px;
            border-radius: 50px; margin-bottom: 30px;
        }
        .tab-btn {
            padding: 10px 24px; border-radius: 40px; background: transparent;
            border: none; color: var(--text-dim); font-weight: 600; cursor: pointer;
            transition: 0.2s; font-size: 16px;
        }
        .tab-btn.active { background: var(--neon-blue); color: white; box-shadow: 0 0 15px var(--neon-blue); }

        .dashboard { padding: 30px; }

        .stats-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 24px; margin-bottom: 40px;
        }
        .stat-card {
            background: var(--card-bg); border-radius: 30px; padding: 25px;
            border: 1px solid rgba(255,255,255,0.05); backdrop-filter: blur(5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .stat-header { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; }
        .stat-icon {
            width: 60px; height: 60px; border-radius: 20px; background: rgba(78, 84, 245, 0.2);
            display: flex; align-items: center; justify-content: center; font-size: 28px;
            color: var(--neon-cyan);
        }
        .stat-value {
            font-size: 42px; font-weight: 700; line-height: 1;
            background: linear-gradient(135deg, #fff, #b0b0ff);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .stat-label { font-size: 14px; color: var(--text-dim); text-transform: uppercase; letter-spacing: 1px; }

        .shop-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 24px; margin-top: 20px;
        }
        .product-card {
            background: var(--card-bg); border-radius: 30px; padding: 24px;
            border: 1px solid rgba(255,255,255,0.05); backdrop-filter: blur(5px);
            transition: 0.2s; display: flex; flex-direction: column; align-items: center;
            text-align: center; cursor: pointer;
        }
        .product-card:hover {
            transform: translateY(-8px); border-color: var(--neon-cyan);
            box-shadow: 0 15px 35px rgba(0,255,255,0.2);
        }
        .product-icon {
            width: 100px; height: 100px; background: rgba(78, 84, 245, 0.2);
            border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 48px; color: var(--neon-cyan); margin-bottom: 20px;
            border: 2px solid transparent; transition: 0.2s;
        }
        .product-card:hover .product-icon { border-color: var(--neon-cyan); box-shadow: 0 0 30px var(--neon-cyan); }
        .product-name { font-size: 22px; font-weight: 600; margin-bottom: 8px; }
        .product-description { font-size: 14px; color: var(--text-dim); margin-bottom: 20px; }
        .product-price {
            font-size: 24px; font-weight: 700; color: var(--neon-green);
            margin-bottom: 20px; display: flex; align-items: center; gap: 8px;
        }
        .btn-buy {
            width: 100%; padding: 14px; border-radius: 40px;
            background: linear-gradient(145deg, var(--neon-blue), #3a3fd4);
            border: none; color: white; font-weight: 600; font-size: 16px;
            cursor: pointer; transition: 0.2s;
        }
        .btn-buy:hover { transform: scale(1.05); box-shadow: 0 0 20px var(--neon-blue); }
        .btn-buy:disabled { opacity: 0.5; pointer-events: none; }

        .table-container {
            background: var(--card-bg); border-radius: 30px; padding: 24px;
            border: 1px solid rgba(255,255,255,0.05); margin-bottom: 30px; overflow-x: auto;
        }
        table { width: 100%; border-collapse: collapse; min-width: 600px; }
        th {
            text-align: left; padding: 16px; background: rgba(0,0,0,0.3);
            color: var(--neon-cyan); font-weight: 600; border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        td { padding: 16px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        tr:hover { background: rgba(255,255,255,0.03); }

        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(8px);
            align-items: center; justify-content: center; z-index: 1000;
        }
        .modal.active { display: flex; }
        .modal-content {
            background: var(--card-bg); border-radius: 40px; padding: 40px;
            max-width: 600px; width: 90%; border: 1px solid rgba(255,255,255,0.1);
            max-height: 80vh; overflow-y: auto;
        }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .modal-header h2 { color: white; }
        .modal-close { background: none; border: none; font-size: 30px; color: var(--text-dim); cursor: pointer; }
        .modal-close:hover { color: white; }

        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; color: var(--text-dim); font-weight: 500; }
        .form-control {
            width: 100%; padding: 16px 20px; border-radius: 40px; border: none;
            background: rgba(0,0,0,0.4); color: white; font-size: 16px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .form-control:focus { outline: none; border-color: var(--neon-cyan); }

        .notification {
            position: fixed; bottom: 30px; right: 30px; padding: 18px 30px;
            border-radius: 60px; background: var(--card-bg); border-left: 6px solid var(--neon-green);
            color: white; font-weight: 600; z-index: 2000; display: none;
            animation: slideIn 0.3s; backdrop-filter: blur(10px); box-shadow: 0 10px 30px black;
        }
        @keyframes slideIn { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        .notification.success { border-left-color: var(--neon-green); }
        .notification.error { border-left-color: var(--neon-pink); }
        .notification.warning { border-left-color: #f8961e; }

        .btn-icon { padding: 8px 12px; margin: 0 4px; }
        .inventory-list { list-style: none; }
        .inventory-item { display: flex; align-items: center; gap: 15px; padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .inventory-item i { width: 30px; text-align: center; color: var(--neon-cyan); }

        @media (max-width: 768px) {
            .header { flex-direction: column; text-align: center; }
            .tabs { flex-wrap: wrap; justify-content: center; }
            .tab-btn { flex: 1 1 auto; }
            .stats-grid { grid-template-columns: 1fr; }
            .shop-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="app">
            <!-- –≠–ö–†–ê–ù –í–•–û–î–ê (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) -->
            <div id="loginScreen" class="screen active"> ... </div> <!-- —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –æ–ø—É—â–µ–Ω–æ –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏, –Ω–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –æ—Ç–≤–µ—Ç–µ –æ–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é, –∫–∞–∫ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ -->

            <!-- –≠–ö–†–ê–ù –£–ß–ê–°–¢–ù–ò–ö–ê (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∫—Ä–æ–º–µ –Ω–∞–∑–≤–∞–Ω–∏–π —Ç–æ–≤–∞—Ä–æ–≤, –Ω–æ –æ–Ω–∏ –ø–æ–¥–≥—Ä—É–∑—è—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞) -->
            <div id="teamScreen" class="screen"> ... </div>

            <!-- –≠–ö–†–ê–ù –û–†–ì–ê–ù–ò–ó–ê–¢–û–†–ê (–î–û–†–ê–ë–û–¢–ê–ù) -->
            <div id="adminScreen" class="screen">
                <div class="header">
                    <div class="logo">
                        <button onclick="logout()" class="btn btn-outline"><i class="fas fa-arrow-left"></i> –í—ã—Ö–æ–¥</button>
                        <div class="logo-icon"><i class="fas fa-crown"></i></div>
                        <div class="logo-text">
                            <h1>–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä</h1>
                            <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–∞–ª–∞–∫—Ç–∏–∫–æ–π</p>
                        </div>
                    </div>
                    <div class="user-info">
                        <span class="impulse-badge"><i class="fas fa-star"></i> –ü–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø</span>
                        <button onclick="refreshAdminData()" class="btn"><i class="fas fa-sync-alt"></i></button>
                    </div>
                </div>

                <div class="dashboard">
                    <div class="tabs">
                        <button class="tab-btn active" onclick="switchAdminTab('teams')">üë• –ö–æ–º–∞–Ω–¥—ã</button>
                        <button class="tab-btn" onclick="switchAdminTab('shop')">üõí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–º</button>
                        <button class="tab-btn" onclick="switchAdminTab('stats')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
                    </div>

                    <!-- –í–∫–ª–∞–¥–∫–∞ –ö–æ–º–∞–Ω–¥—ã (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è) -->
                    <div id="adminTeamsTab" style="display: block;">
                        <div class="table-container">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                <h3><i class="fas fa-users"></i> –í—Å–µ –∫–æ–º–∞–Ω–¥—ã</h3>
                                <button onclick="showAddTeamModal()" class="btn btn-success"><i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å</button>
                            </div>
                            <table id="allTeamsTable">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                                        <th>–ò–º–ø—É–ª—å—Å—ã</th>
                                        <th>–ö—É–ø–ª–µ–Ω–æ</th>
                                        <th>–ü–æ—Ç—Ä–∞—á–µ–Ω–æ</th>
                                        <th>–ö–æ–¥</th>
                                        <th>–ö–æ–Ω—Ç–∞–∫—Ç</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody id="teamsTableBody"></tbody>
                            </table>
                        </div>

                        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –∫–æ–º–∞–Ω–¥—ã -->
                        <div id="inventoryModal" class="modal">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h2 id="inventoryTeamName">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∫–æ–º–∞–Ω–¥—ã</h2>
                                    <button class="modal-close" onclick="closeModal('inventoryModal')">&times;</button>
                                </div>
                                <div id="inventoryList"></div>
                            </div>
                        </div>

                        <div class="stats-grid"> ... </div> <!-- –±–ª–æ–∫–∏ –±—ã—Å—Ç—Ä–æ–≥–æ –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) -->
                    </div>

                    <!-- –í–∫–ª–∞–¥–∫–∞ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–æ–º (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) -->
                    <div id="adminShopTab" style="display: none;"> ... </div>

                    <!-- –í–∫–ª–∞–¥–∫–∞ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) -->
                    <div id="adminStatsTab" style="display: none;"> ... </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê (–¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–ª—è –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è) -->
    <!-- –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ (addTeam, editTeam, addItem, editItem) –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π -->

    <div id="notification" class="notification"></div>

    <script>
        // ================= –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø =================
        const CONFIG = {
            SCRIPT_URL: 'https://script.google.com/macros/s/AKfycbxTNI6dJgYckKqFin7-lIeJol4vkvbkjkdRRZu27vy6EcRb7qDUg-wUT_xLevyBEdLO/exec', // –ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –°–í–û–ô URL
            ADMIN_PASSWORD: 'org2026',
            REFRESH_INTERVAL: 30000
        };

        // ================= –°–û–°–¢–û–Ø–ù–ò–ï =================
        let currentState = {
            team: null,
            isAdmin: false,
            adminPassword: '',
            allTeams: [],
            allItems: [],
            purchases: [],
            transactions: [],
            rating: []
        };

        // ================= –û–ë–©–ò–ï –§–£–ù–ö–¶–ò–ò =================
        function showNotification(message, type = 'info') {
            const notif = document.getElementById('notification');
            notif.textContent = message;
            notif.className = `notification ${type}`;
            notif.style.display = 'block';
            setTimeout(() => { notif.style.display = 'none'; }, 3000);
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // ================= –ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø =================
        // (—Ñ—É–Ω–∫—Ü–∏–∏ loginAsTeam, loginAsAdmin, logout –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
        // ... (–æ–ø—É—â–µ–Ω–æ –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏, –Ω–æ –¥–æ–ª–∂–Ω—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é)

        // ================= –ó–ê–ì–†–£–ó–ö–ê –î–ê–ù–ù–´–• –û–†–ì–ê–ù–ò–ó–ê–¢–û–†–ê (–æ–±–Ω–æ–≤–ª–µ–Ω–æ) =================
        async function loadAdminData() {
            try {
                const [teamsRes, itemsRes, transRes] = await Promise.all([
                    fetch(`${CONFIG.SCRIPT_URL}?action=getTeams`),  // —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                    fetch(`${CONFIG.SCRIPT_URL}?action=getShopItems`),
                    fetch(`${CONFIG.SCRIPT_URL}?action=getTransactions`)
                ]);
                const teamsData = await teamsRes.json();
                const itemsData = await itemsRes.json();
                const transData = await transRes.json();

                if (teamsData.success) currentState.allTeams = teamsData.data.teams || [];
                if (itemsData.success) currentState.allItems = itemsData.data.items || [];
                if (transData.success) currentState.transactions = transData.data.transactions || [];

                updateAdminUI();
            } catch (e) {
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö', 'error');
            }
        }

        function updateAdminUI() {
            // –¢–∞–±–ª–∏—Ü–∞ –∫–æ–º–∞–Ω–¥ —Å –Ω–æ–≤—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏
            let teamsHtml = '';
            if (currentState.allTeams.length) {
                currentState.allTeams.forEach(t => {
                    teamsHtml += `<tr>
                        <td>${t.id}</td>
                        <td>${t.name}</td>
                        <td>${t.score}</td>
                        <td>${t.purchasedCount || 0}</td>
                        <td>${t.totalSpent || 0}</td>
                        <td>${t.code}</td>
                        <td>${t.contact || '-'}</td>
                        <td>
                            <button class="btn btn-primary btn-icon" onclick="openEditTeamModal(${t.id})" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"><i class="fas fa-edit"></i></button>
                            <button class="btn btn-info btn-icon" onclick="showTeamInventory(${t.id})" title="–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å"><i class="fas fa-box"></i></button>
                        </td>
                    </tr>`;
                });
            } else teamsHtml = '<tr><td colspan="8">–ù–µ—Ç –∫–æ–º–∞–Ω–¥</td></tr>';
            document.getElementById('teamsTableBody').innerHTML = teamsHtml;

            // –°–µ–ª–µ–∫—Ç—ã –¥–ª—è –Ω–∞—á–∏—Å–ª–µ–Ω–∏—è
            let options = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É</option>';
            currentState.allTeams.forEach(t => options += `<option value="${t.id}">${t.name} (${t.score} ‚ö°)</option>`);
            document.getElementById('quickTeamSelect').innerHTML = options;
            document.getElementById('manualTeamSelect').innerHTML = options;

            // –¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
            let itemsHtml = '';
            if (currentState.allItems.length) {
                currentState.allItems.forEach(i => {
                    itemsHtml += `<tr>
                        <td>${i.id}</td>
                        <td><i class="${i.icon}"></i></td>
                        <td>${i.name}</td>
                        <td>${i.description}</td>
                        <td>${i.price}</td>
                        <td>
                            <button class="btn btn-primary btn-icon" onclick="openEditItemModal(${i.id})"><i class="fas fa-edit"></i></button>
                        </td>
                    </tr>`;
                });
            } else itemsHtml = '<tr><td colspan="6">–ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</td></tr>';
            document.getElementById('itemsTableBody').innerHTML = itemsHtml;

            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            document.getElementById('totalTeamsStat').textContent = currentState.allTeams.length;
            const totalImp = currentState.allTeams.reduce((acc, t) => acc + (t.score || 0), 0);
            document.getElementById('totalImpulsesStat').textContent = totalImp;
            const totalPurchases = currentState.allTeams.reduce((acc, t) => acc + (t.purchasedCount || 0), 0);
            document.getElementById('totalPurchasesStat').textContent = totalPurchases;

            // –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
            let transHtml = '<table><tr><th>–í—Ä–µ–º—è</th><th>–ö–æ–º–∞–Ω–¥–∞</th><th>–ò–º–ø—É–ª—å—Å—ã</th><th>–ü—Ä–∏—á–∏–Ω–∞</th></tr>';
            if (currentState.transactions.length) {
                currentState.transactions.slice(0,10).forEach(t => {
                    const team = currentState.allTeams.find(tt => tt.id == t.teamId);
                    transHtml += `<tr><td>${new Date(t.timestamp).toLocaleString()}</td><td>${team ? team.name : t.teamId}</td><td>${t.points}</td><td>${t.reason}</td></tr>`;
                });
            } else transHtml += '<tr><td colspan="4">–ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π</td></tr>';
            transHtml += '</table>';
            document.getElementById('recentTransactionsAdmin').innerHTML = transHtml;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å –∫–æ–º–∞–Ω–¥—ã (–Ω–æ–≤–æ–µ)
        async function showTeamInventory(teamId) {
            const team = currentState.allTeams.find(t => t.id == teamId);
            if (!team) return;
            document.getElementById('inventoryTeamName').textContent = `–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –∫–æ–º–∞–Ω–¥—ã ${team.name}`;
            document.getElementById('inventoryList').innerHTML = '–ó–∞–≥—Ä—É–∑–∫–∞...';
            document.getElementById('inventoryModal').classList.add('active');

            try {
                const res = await fetch(`${CONFIG.SCRIPT_URL}?action=getTeamInventory&teamId=${teamId}`);
                const data = await res.json();
                if (data.success && data.data.items) {
                    const items = data.data.items;
                    let html = '<ul class="inventory-list">';
                    if (items.length) {
                        items.forEach(item => {
                            html += `<li class="inventory-item">
                                <i class="${item.icon}"></i>
                                <span><strong>${item.name}</strong> ‚Äî ${item.description} (—Ü–µ–Ω–∞: ${item.price} ‚ö°)</span>
                            </li>`;
                        });
                    } else {
                        html += '<li>–£ –∫–æ–º–∞–Ω–¥—ã –ø–æ–∫–∞ –Ω–µ—Ç –∫—É–ø–ª–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤.</li>';
                    }
                    html += '</ul>';
                    document.getElementById('inventoryList').innerHTML = html;
                } else {
                    document.getElementById('inventoryList').innerHTML = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
                }
            } catch (e) {
                document.getElementById('inventoryList').innerHTML = '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏';
                showNotification('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è', 'error');
            }
        }

        // ================= –û–°–¢–ê–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) =================
        // ... (—Ñ—É–Ω–∫—Ü–∏–∏ quickAddImpulses, manualAddPoints, CRUD –∫–æ–º–∞–Ω–¥ –∏ —Ç–æ–≤–∞—Ä–æ–≤, –ø–æ–∫—É–ø–∫–∞ –∏ —Ç.–¥.)
        // –í–∞–∂–Ω–æ: –≤ —Ñ—É–Ω–∫—Ü–∏–∏ addTeam, updateTeam –∏ —Ç.–¥. –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å currentState.adminPassword

        // ================= –ê–í–¢–û–û–ë–ù–û–í–õ–ï–ù–ò–ï =================
        let refreshInterval;
        function startAutoRefresh() {
            stopAutoRefresh();
            refreshInterval = setInterval(() => {
                if (currentState.team) loadTeamData();
                else if (currentState.isAdmin) loadAdminData();
            }, CONFIG.REFRESH_INTERVAL);
        }
        function stopAutoRefresh() { if (refreshInterval) clearInterval(refreshInterval); }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        window.loginAsTeam = loginAsTeam;
        window.loginAsAdmin = loginAsAdmin;
        window.logout = logout;
        window.buyItem = buyItem;
        window.quickAddImpulses = quickAddImpulses;
        window.manualAddPoints = manualAddPoints;
        window.showAddTeamModal = showAddTeamModal;
        window.addTeam = addTeam;
        window.openEditTeamModal = openEditTeamModal;
        window.updateTeam = updateTeam;
        window.deleteTeam = deleteTeam;
        window.showAddItemModal = showAddItemModal;
        window.addItem = addItem;
        window.openEditItemModal = openEditItemModal;
        window.updateItem = updateItem;
        window.deleteItem = deleteItem;
        window.closeModal = closeModal;
        window.switchTeamTab = switchTeamTab;
        window.switchAdminTab = switchAdminTab;
        window.refreshTeamData = loadTeamData;
        window.refreshAdminData = loadAdminData;
        window.showTeamInventory = showTeamInventory;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–ø—Ä–æ–≤–µ—Ä–∫–∞ localStorage) ...
    </script>
</body>
</html>
